from model import editing_employees, removing_employees, get_all_employees, fire_employees, user, Sending_a_job_application,create_main_window,Get_everyone_to_work
from view import display_menu,  display_success, display_error
import json
import tkinter as tk

def main():
    employee_list = []

    while True:
        display_menu()
        choice = input("\nSelect an action (1-7): ")

        if choice == "1":
            root6 = tk.Tk()
            root6.title("Employee Registration")
            root6.geometry("400x400")

            labels = ["Имя", "Фамилия", "Отчество", "Возраст", "желаемое положение", "опыт", "ID"]
            entries = []
            for label_text in labels:
                label = tk.Label(root6, text=label_text)
                label.pack()
                entry = tk.Entry(root6)
                entry.pack()
                entries.append(entry)

            employee_list = []

            def submit_callback():
                The_database = {}
                for i, entry in enumerate(entries):
                    value = entry.get()
                    if i == 3:
                        value = int(value)
                    The_database[labels[i]] = value

                employee_list.append(The_database)

                with open('The_database.json', 'w', encoding='utf-8') as f:
                    json.dump(employee_list, f, ensure_ascii=False, indent=2)

                success_label = tk.Label(root6, text="Сотрудник успешно принят.")
                success_label.pack()

                for entry in entries:
                    entry.delete(0, tk.END)

            submit_button = tk.Button(root6, text="Отправить", command=submit_callback)
            submit_button.pack()

            root6.mainloop()
        elif choice == "2":
            get_all_employees(root3)
        elif choice == "3":
            editing_employees()
        elif choice == "4":
            index = int(input("Enter the ID of the employee you want to remove: "))
            removed_employee = removing_employees(index)
            if removed_employee:
                display_success(f"Name {removed_employee['Name']}, Surname {removed_employee['Surname']}, Middle_name {removed_employee['Middle_name']}, age {removed_employee['age']}, desired position {removed_employee['desired position']}, experience {removed_employee['experience']} deleted.")
            else:
                display_error("Invalid employee ID.")
        elif choice == "5":
            create_main_window()
        elif choice == "6":
            Get_everyone_to_work()
        elif choice == "7":
            fire_employees()
            print("Exiting the program.")
            break
        else:
            display_error("Wrong choice. Please choose from this")

Log_in_to_the_system = input("\n Welcome to the cafe 'Home comfort'!"
                             "\n 1 - Admin Mode"
                             "\n 2 - Buyer's mode"
                             "\n 3 - Application submission mode"
                             "\n Enter the number of the desired action:")
if Log_in_to_the_system == "1":
    global Password
    Password = "2"
    num = input("Enter the password:")
    if Password == num:
        main()
    else:
        print("\n You entered the password incorrectly!"
                "\n You're not an admin, goodbye!")
elif Log_in_to_the_system == "2":
    user()
elif Log_in_to_the_system == "3":
    print("Перейдите в телеграмм, для этого введите в строке поиска @Projectbot12345bot")
    Sending_a_job_application()


if __name__ == "main":
    main()
